$(function(){function e(){if(0==window.orientation||180==window.orientation){$("body").attr("class","portrait"),orientation="portrait",t.touchSlide();var e=$(".j-tab1").children("ul").children("li"),i=e.length;return 1==i?e.css({width:"100%"}):2==i?e.css({width:"50%"}):e.css({width:"33.3333%"}),!1}if(90==window.orientation||window.orientation==-90){$("body").attr("class","landscape"),orientation="landscape",t.touchSlide();var e=$(".j-tab1").children("ul").children("li"),i=e.length;return 1==i?e.css({width:"100%"}):2==i?e.css({width:"50%"}):e.css({width:"33.3333%"}),!1}}var i=function(){var e=this;e.init(),e.params={phaseID:API.getQueryString("phaseID"),subjectID:API.getQueryString("subjectID"),url:decodeURIComponent(API.getQueryString("url"))},e.getData()};i.prototype={init:function(){var e=this;e.jdom={subjectTab:$("#subjectTab"),phaseUl:$(".phaseUl")},e.icons={"语文":"chinese","数学":"math","英语":"english","历史":"history","政治":"politics","地理":"geography","物理":"physics","化学":"chemistry","生物":"biology","科学":"science","理科综合":"science-synthesis","文科综合":"arts-synthesis","信息技术":"it","通用技术":"general-technique"},e.bindUI()},bindUI:function(){var e=this;e.jdom.subjectTab.on("click",".discipline ul li",function(i){var t=$(this),a=t.parent();window.location.href=API.format(e.params.url,{subjectID:t.attr("sid"),phaseID:a.attr("pid"),subjectName:a.attr("pname")+t.find("a").html()})})},getData:function(){var e=this;API.ajax("getsubjects",{},function(i){i&&0==i.status&&i.phaseData.length>0?e.render(i):layer.open({content:"没有获取到数据",btn:"我知道了"})})},touchSlide:function(){var e=this;index=e.index||0,e._touchSlide=new TouchSlide({slideCell:"#subjectTab",delayTime:600,defaultIndex:index,startFun:function(e,i){}})},changePhase:function(e,i){var t=this;e&&(t.index=t.jdom.phaseUl.find("li[pid="+e+"]").attr("index")),$(".discipline").find("ul[pid="+e+"]").find("li[sid="+i+"]").addClass("select")},render:function(i){for(var t=this,a="",n="",s=0,c=i.phaseData.length;s<c;s++){a+='<li index="'+s+'" pid="'+i.phaseData[s].phaseID+'" class="learning-stage-li"><span class="learning-stage-grade">'+i.phaseData[s].phaseName+"</span></li>";for(var r=i.subjectData[""+i.phaseData[s].phaseID],l='<ul pid="'+i.phaseData[s].phaseID+'" pname="'+i.phaseData[s].phaseName+'" class="discipline-subject cf">',h=0,d=r.length;h<d;h++)l+='<li sid="'+r[h].subjectID+'" class="discipline-subject-li '+t.icons[r[h].subjectName]+'"><a href="javascript:;">'+r[h].subjectName+"</a></li>";l+="</ul>",n+=l}t.jdom.phaseUl.html(a),$(".discipline").html(n),t.changePhase(t.params.phaseID,t.params.subjectID),e()}};var t=new i;$(window).bind("orientationchange",function(i){e()})});