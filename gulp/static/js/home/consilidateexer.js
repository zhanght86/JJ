var consolidateexerobj;$(function(){function e(){if(0==window.orientation||180==window.orientation){$("body").attr("class","portrait"),orientation="portrait";var e=$(window).width(),a=$(window).height();$(".container").width(e);var t=$(".topic-analysis").height(),s=$(".fix-tab").height();return $(".consolidateexer-mainbody").height(a-t-s),!1}if(90==window.orientation||window.orientation==-90){$("body").attr("class","landscape"),orientation="landscape";var e=$(window).width(),a=$(window).height();$(".container").width(.66*e);var t=$(".topic-analysis").height(),s=$(".fix-tab").height();return $(".consolidateexer-mainbody").height(a-t-s),!1}}var a=function(){var e=this;e.init(),e.params={phaseID:API.getQueryString("phaseID"),subjectID:API.getQueryString("subjectID"),subjectName:API.getQueryString("subjectName"),timeID:API.getQueryString("timeID"),timeName:API.getQueryString("timeName"),multiChild:API.getQueryString("multiChild"),role:API.getQueryString("role"),name:API.getQueryString("name")},e.paperResource="01",e.qidResource="05",e.getData()};a.prototype={init:function(){var e=this;e.jdom={subjectDiv:$(".subjectDiv"),subjectName:$(".subjectDiv .subject-knowledge"),xxchoose:$(".xxchoose"),zschoose:$(".zschoose")},e.bindUI()},bindUI:function(){var e=this;e.jdom.xxchoose.on("click","a",function(a){e.goto1($(this),"01",e.xxtype)}),e.jdom.zschoose.on("click","a",function(a){e.goto1($(this),"05",e.zstype)}),$(".btn-topicAnalysis").click(function(a){window.open("knowledge.html?phaseID="+e.params.phaseID+"&subjectID="+e.params.subjectID+"&sName="+e.params.subjectName+"&pr="+e.paperResource+"&qr="+e.qidResource,"knowledge")}),e.jdom.subjectDiv.click(function(a){API.stopPropagation(a);var t="?phaseID={phaseID}&subjectID={subjectID}&subjectName={subjectName}"+API.format("&timeID={timeID}&timeName={timeName}&multiChild={multiChild}&role={role}&name={name}",e.params);window.location.href="choosesubject.html?phaseID="+e.params.phaseID+"&subjectID="+e.params.subjectID+"&url="+encodeURIComponent(window.location.href.split("?")[0]+t)}),$(".btnChild").click(function(){var e="?phaseID={phaseID}&subjectID={subjectID}&subjectName={subjectName}&timeID={timeID}&timeName={timeName}&multiChild={multiChild}&role={role}&name={name}";window.location.href="tabchild.html?type=1&url="+encodeURIComponent(window.location.href.split("?")[0]+e)}),$(".btnMistake").click(function(){window.location.href=API.format("Mymistakes.html?phaseID={phaseID}&subjectID={subjectID}&subjectName={subjectName}&timeID={timeID}&timeName={timeName}&multiChild={multiChild}&role={role}&name={name}",e.params)})},goto1:function(e,a,t){var s=this;e.hasClass("choose-subject-a")?window.location.href="consolidateexeall.html?phaseID="+s.params.phaseID+"&subjectID="+s.params.subjectID+"&subjectName="+s.params.subjectName+"&paperResource="+s.paperResource+"&qidResource="+a+"&indexType="+t:"1"==e.attr("isPractice")?window.open("ExerciseScore.html?phaseID="+s.params.phaseID+"&subjectID="+s.params.subjectID+"&paperID="+e.attr("paperID")+"&paperResource="+s.paperResource+"&qidResource="+a,"ExerciseScore"):window.open("Exercise.html?paperID="+e.attr("paperID")+"&phaseID="+s.params.phaseID+"&subjectID="+s.params.subjectID+"&paperResource="+s.paperResource+"&qidResource="+a,"Exercise")},getStatistics:function(){var e=this;API.ajax("getStatistics",{phaseID:e.params.phaseID,subjectID:e.params.subjectID,timeID:e.params.timeID},function(e){e&&0==e.status&&($("span.todayExercise").html(e.todayExercise),$("span.statisticsExercise").html(e.statisticsExercise))})},getData:function(){var e=this;0==e.params.phaseID.length?API.ajax("getAccessRec",{type:1},function(a){a&&0==a.status?e.setAccessRec(a):layer.open({content:a.msg||"没有获取到数据",btn:"我知道了"})}):e.jdom.subjectName.html(e.params.subjectName),API.ajax("getRecommend",{phaseID:e.params.phaseID,subjectID:e.params.subjectID},function(a){a&&0==a.status?e.render(a):layer.open({content:a.msg||"没有获取到数据",btn:"我知道了"})}),"0"==e.params.role?($(".textChild").html(e.params.name),"1"==e.params.multiChild?$(".btnChild").show():$(".btnChild").hide(),$(".changeChild").show()):$(".changeChild").height(0),e.getStatistics(),API.localStorage("defaultTree","")},setAccessRec:function(e){var a=this;e.subjectID&&(a.params.phaseID=e.phaseID,a.params.subjectID=e.subjectID,a.params.subjectName=e.subjectName,a.params.timeID=e.timeID,a.params.timeName=e.timeName,a.jdom.subjectName.html(e.subjectName))},createHtml:function(e){for(var a="",t=0,s=e.length;t<s;t++){var c=e[t];1==c.isPractice?(c.noeasy="",c.accuracy="accuracy accuracy-",c.accuracyp="accuracy-p1",c.percent<60?c.accuracy+="red":c.percent<80?c.accuracy+="yellow":c.accuracy+="green",c.percent_=c.percent+"%"):(c.noeasy="no-easy-wrong",c.accuracy="accuracy-respondence",c.accuracyp="accuracy-span1",c.percent_="去答题"),a+=API.format('<a paperID="{paperID}" isPractice="{isPractice}" class="autoData" href="javascript:;"> <div class="easy-wrong {noeasy} cf"> <div class="{accuracy}"> <p class="{accuracyp}">{percent_}</p> </div> <span class="choose-name">{paperName}</span> <p class="easy-p"> <span class="easy-date">推荐时间</span> <span class="easy-topic">{recommendDateStr}</span> </p> <p class="easy-p"> <span class="easy-date">题数：</span> <span class="easy-topic">{questionCount}题</span> </p> </div> </a>',c)}return 0==a.length&&(a='<div class="no-recommend autoData"><p class="no-recommend-tit">暂无推荐，去自主练习挑战下吧~</p> </div>'),a},render:function(e){var a=this;a.zstype=e.zstype,a.xxtype=e.xxtype,$(".autoData").remove(),a.jdom.xxchoose.append(a.createHtml(e.xxdata)),a.jdom.zschoose.append(a.createHtml(e.zsdata))}},consolidateexerobj=new a,$(window).bind("orientationchange",function(a){e()}),e()});