function changeSubject(e){knowledgeobj.changeSubject(e)}var knowledgeobj;$(function(){function e(){if(0==window.orientation||180==window.orientation){$("body").attr("class","portrait"),orientation="portrait";var e=$(window).width();$(window).height();return $(".container").width(e),!1}if(90==window.orientation||window.orientation==-90){$("body").attr("class","landscape"),orientation="landscape";var e=$(window).width();$(window).height();return $(".container").width(.66*e),!1}}var a=function(){var e=this;e.params={phaseID:API.getQueryString("phaseID"),subjectID:API.getQueryString("subjectID"),subjectName:API.getQueryString("sName"),paperResource:API.getQueryString("pr"),qidResource:API.getQueryString("qr"),level:API.getQueryString("level")||0,knowlegeID:API.getQueryString("knowlegeID")||0},e.init(),e.getData()};a.prototype={init:function(){var e=this;e.jdom={subjectDiv:$(".present-subject"),subjectName:$(".present-subject .subject-knowledge"),allData:$(".allData")},e.jdom.subjectName.html(e.params.subjectName),0==e.params.level&&e.jdom.subjectDiv.removeClass("hide"),e.bindUI()},bindUI:function(){var e=this;e.jdom.subjectDiv.click(function(a){API.stopPropagation(a);var t=API.format("?pr={paperResource}&qr={qidResource}&level={level}&knowlegeID={knowlegeID}",e.params)+"&phaseID={phaseID}&subjectID={subjectID}&sName={subjectName}";window.location.href="choosesubject.html?phaseID="+e.params.phaseID+"&subjectID="+e.params.subjectID+"&url="+encodeURIComponent(window.location.href.split("?")[0]+t)}),e.jdom.allData.on("click","a",function(a){var t=$(this);"0"==t.attr("isleaf")?window.location.href="knowledge.html?phaseID="+e.params.phaseID+"&subjectID="+e.params.subjectID+"&level="+t.attr("level")+"&knowlegeID="+t.attr("kid")+"&pr="+e.params.paperResource+"&qr="+e.params.qidResource:(layer.open({type:2,content:"正在生成试题...",shadeClose:!1}),API.ajax("createPaper",{phaseID:e.params.phaseID,subjectID:e.params.subjectID,knowledgeID:t.attr("kid")},function(a){layer.closeAll(),a&&0==a.status?window.location.href="Exercise.html?paperID="+a.paperID+"&phaseID="+e.params.phaseID+"&subjectID="+e.params.subjectID+"&paperResource="+e.params.paperResource+"&qidResource="+e.params.qidResource+"&r="+(new Date).getTime():layer.open({content:a.msg,btn:"我知道了"})}))})},getData:function(){var e=this;API.ajax("getKnowlege",{phaseID:e.params.phaseID,subjectID:e.params.subjectID,knowledgeID:e.params.knowlegeID,level:e.params.level},function(a){a&&0==a.status?e.render(a.knowledgeInfo):layer.open({content:"没有获取到数据",btn:"我知道了"})})},changeSubject:function(e){var a=this;e.subjectID&&(a.params.phaseID=e.phaseID,a.params.subjectID=e.subjectID,a.params.subjectName=e.subjectName,a.jdom.subjectName.html(e.subjectName),a.jdom.allData.empty(),a.getData())},render:function(e){for(var a=this,t="",n=0,s=e.length;n<s;n++)t+=API.format('<a kid="{knowledgeID}" level="{nextLevel}" isleaf="{isLeaf}" href="javascript:;"><div class="time-group"><span class="choose-name">{knowledgeName}</span><span class="choose-icon"></span></div></a>',e[n]);a.jdom.allData.html(t)}},knowledgeobj=new a,$(window).bind("orientationchange",function(a){e()}),e()});